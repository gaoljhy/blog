# 垃圾回收机制

## 变量逃逸分析

在 go 中的变量存放在 堆还是栈上，空间的开辟，就由gc默认分配，默认处理回收

Go语言自带垃圾回收机制（GC）。GC 通过独立的进程执行，它会搜索不再使用的变量，并将其释放。需要注意的是，GC 在运行时会占用机器资源。

GC 是自动进行的，如果要手动进行 GC，可以使用 `runtime.GC()` 函数，显式的执行 GC。

显式的进行 GC 只在某些特殊的情况下才有用，比如当内存资源不足时调用 `runtime.GC()` ，这样会立即释放一大片内存，但是会造成程序短时间的性能下降。

`finalizer`（终止器）是与对象关联的一个函数，通过 `runtime.SetFinalizer` 来设置

如果某个对象定义了 `finalizer`，当它被 `GC` 时候，这个 `finalizer` 就会被调用，以完成一些特定的任务，例如发信号或者写日志等。


` func SetFinalizer(x, f interface{})`

参数说明如下：

    参数 `x` 必须是一个指向通过 `new` 申请的对象的指针，或者通过对复合字面值取址得到的指针。
    参数 `f` 必须是一个函数，它接受单个可以直接用 `x` 类型值赋值的参数，也可以有任意个被忽略的返回值。


