<div class="rich_media_content " id="js_content" style="visibility: visible;">

    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;background-color: rgb(255, 255, 255);text-align: center;">
        <span style="color: rgb(255, 0, 0);font-size: 19px;">一<strong>、基础</strong></span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>1、说明：创建数据库<br><span style="color: teal;">CREATE DATABASE
                database-name</span></strong><br><strong>2</strong><strong>、说明：删除数据库<br><span style="color: blue;">drop
                database dbname</span></strong><strong>3、说明：备份sql server<br><span style="color: teal;">---&nbsp;创建
                备份数据的&nbsp;device<br>USE master<br>EXEC sp_addumpdevice 'disk', 'testBack',
                'c:\mssql7backup\MyNwind_1.dat'<br>---&nbsp;开始 备份<br>BACKUP DATABASE pubs TO
                testBack</span></strong><span style="color: teal;">&nbsp;<br></span><strong>4、说明：创建新表<br><span
                style="color: rgb(153, 51, 0);">create table tabname(col1 type1 [not null] [primary key],col2 type2 [not
                null],..</span><span style="color: teal;">)</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>根据已有的表创建新表：&nbsp;</strong><br><strong><span style="color: blue;">A：create table tab_new like tab_old
                (使用旧表创建新表)</span></strong><span style="color: blue;"><br><strong>B</strong></span><strong><span
                style="color: blue;">：create table tab_new as select col1,col2… from tab_old definition
                only</span></strong><strong>5、说明：删除新表<br><span style="color: maroon;">drop table
                tabname</span></strong><span style="color: teal;">&nbsp;<br></span><strong>6、说明：增加一个列<br><span
                style="color: blue;">Alter table tabname add column col type</span></strong><strong><span
                style="color: red;">注</span></strong>：列增加后将不能删除。DB2中列加上后数据类型也不能改变，唯一能改变的是增加varchar类型的长度。<br><strong>7、说明：添加主键</strong>：&nbsp;<strong><span
                style="color: teal;">Alter table tabname add primary key(col)&nbsp;<br></span></strong><span
            style="color: blue;">说明：删除主键</span>：<strong><span style="color: maroon;">&nbsp;Alter table tabname drop
                primary key(col)&nbsp;</span></strong><strong>8、说明：创建索引</strong>：<strong><span
                style="color: blue;">create [unique] index idxname on tabname(col….)&nbsp;<br></span></strong><span
            style="color: blue;">删除索引</span>：<strong><span style="color: green;">drop index
                idxname</span></strong><br><span
            style="color: blue;">注：索引是不可更改的，想更改必须删除重新建。</span><br><strong>9</strong><strong>、说明：创建视图</strong>：<span
            style="color: green;">create view viewname as select statement&nbsp;</span><br><strong>删除视图</strong>：<span
            style="color: green;">drop view viewname</span><br><strong>10</strong><strong>、说明：几个简单的基本的sql语句<br><span
                style="color: green;">选择：</span></strong><span style="color: blue;">select * from table1
            where&nbsp;范围<br></span><strong><span style="color: green;">插入：</span></strong><span
            style="color: rgb(153, 51, 102);">insert into table1(field1,field2)
            values(value1,value2)<br></span><strong><span style="color: green;">删除：</span></strong><span
            style="color: blue;">delete from table1 where&nbsp;范围</span><strong><span
                style="color: green;">更新</span></strong><span style="color: green;">：</span><span
            style="color: rgb(153, 51, 102);">update table1 set field1=value1 where&nbsp;范围<br></span><strong><span
                style="color: green;">查找</span></strong><span style="color: green;">：</span><span
            style="color: blue;">select * from table1 where field1 like ’%value1%’
            ---like的语法很精妙，查资料!<br></span><strong><span style="color: green;">排序</span></strong><span
            style="color: green;">：</span><span style="color: rgb(153, 51, 102);">select * from table1 order by
            field1,field2 [desc]<br></span><strong><span style="color: green;">总数</span></strong><span
            style="color: green;">：</span><span style="color: blue;">select count as totalcount from
            table1<br></span><strong><span style="color: green;">求和</span></strong><span
            style="color: green;">：</span><span style="color: rgb(153, 51, 102);">select sum(field1) as sumvalue from
            table1<br></span><strong><span style="color: green;">平均</span></strong><span
            style="color: green;">：</span><span style="color: blue;">select avg(field1) as avgvalue from
            table1<br></span><strong><span style="color: green;">最大</span></strong><span
            style="color: green;">：</span><span style="color: rgb(153, 51, 102);">select max(field1) as maxvalue from
            table1<br></span><strong><span style="color: green;">最小</span></strong><span
            style="color: green;">：</span><span style="color: blue;">select min(field1) as minvalue from
            table1<br></span><strong>11、说明：几个高级查询运算词<br>A：&nbsp;<span
                style="color: green;">UNION&nbsp;运算符</span></strong>&nbsp;<br><span style="color: blue;">UNION
            运算符通过组合其他两个结果表（例如 TABLE1 和 TABLE2）并消去表中任何重复行而派生出一个结果表。当 ALL 随 UNION 一起使用时（即 UNION
            ALL），不消除重复行。两种情况下，派生表的每一行不是来自 TABLE1 就是来自 TABLE2</span>。&nbsp;<br><strong><span
                style="color: green;">B：EXCEPT 运算符&nbsp;<br></span>EXCEPT</strong><span
            style="color: rgb(153, 51, 102);">运算符通过包括所有在 TABLE1 中但不在 TABLE2 中的行并消除所有重复行而派生出一个结果表。当 ALL 随 EXCEPT
            一起使用时&nbsp;(EXCEPT ALL)，不消除重复行。</span><br><strong><span style="color: green;">C：INTERSECT
            </span>运算符<br>INTERSECT</strong><span style="color: blue;">运算符通过只包括 TABLE1 和 TABLE2
            中都有的行并消除所有重复行而派生出一个结果表。当&nbsp;</span><strong>ALL</strong><span style="color: blue;">随 INTERSECT
            一起使用时&nbsp;(INTERSECT ALL)，不消除重复行。&nbsp;<br></span><strong><span style="color: red;">注：</span></strong><span
            style="color: blue;">使用运算词的几个查询结果行必须是一致的</span>。&nbsp;<br><strong>12</strong><strong>、说明：使用外连接&nbsp;<br></strong>A、<strong>left&nbsp;（outer）&nbsp;join</strong>：&nbsp;<br>左<span
            style="color: rgb(153, 51, 102);">外连接（左连接）：结果集几包括连接表的匹配行，也包括左连接表的所有行。&nbsp;<br>SQL: select a.a, a.b, a.c,
            b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c<br></span><strong>B：right （outer）
            join:&nbsp;</strong><br><span
            style="color: blue;">右外连接(右连接)：结果集既包括连接表的匹配连接行，也包括右连接表的所有行。&nbsp;<br></span><strong>C：full/cross （outer）
            join</strong>：&nbsp;<br><span
            style="color: rgb(153, 51, 0);">全外连接：不仅包括符号连接表的匹配行，还包括两个连接表中的所有记录。</span><br><strong>12</strong><strong>、分组<span
                style="color: blue;">:Group by:<br>&nbsp;&nbsp;&nbsp;</span></strong><span style="color: blue;">一张表，一旦分组
            完成后，查询后只能得到组相关的信息。<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span
                style="color: maroon;">组相关的信息：</span></strong><span
            style="color: blue;">（统计信息）&nbsp;count,sum,max,min,avg&nbsp;<strong>&nbsp;</strong><strong>分组的标准)<br>&nbsp;&nbsp;</strong></span><strong>&nbsp;&nbsp;在<span
                style="color: red;">SQLServer</span>中分组时：不能以<span style="color: blue;">text</span>,<span
                style="color: blue;">ntext</span>,<span style="color: blue;">image</span>类型的字段作为分组依据<span
                style="color: blue;"><br>&nbsp;&nbsp;&nbsp;</span>在<span style="color: blue;">selecte</span><span
                style="color: red;">统计函数</span><span style="color: blue;">中的字段，不能和</span><span
                style="color: red;">普通</span><span style="color: blue;">的字段放在一起；</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>13、对数据库进行操作：<br>&nbsp;&nbsp;&nbsp;<span style="color: green;">分离数据库</span></strong><span
            style="color: green;">：</span><strong>&nbsp;sp_detach_db;<span
                style="color: green;">附加数据库</span></strong>：<strong>sp_attach_db&nbsp;</strong>后接表明，附加需要完整的路径名<br><strong>14.</strong><strong>如何修改数据库的名称:</strong><span
            style="color: blue;"><br>sp_renamedb 'old_name', 'new_name'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: center;background: white;">
        <strong><span style="font-size: 20px;color: red;">二、提升</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>1、说明：复制表(只复制结构,源表名：a 新表名：b) (Access可用)<br><span style="color: green;">法一：</span></strong><span
            style="color: blue;">select * into b from a where 1&lt;&gt;1（</span><span
            style="color: rgb(255, 102, 0);">仅用于SQlServer</span><span style="color: blue;">）</span><strong><span
                style="color: green;">法二：</span></strong><span style="color: blue;">select top 0 * into b from
            a<br></span><strong>2、说明：拷贝表(拷贝数据,源表名：a 目标表名：b) (Access可用)<br></strong><span style="color: blue;">insert
            into b(a, b, c) select d,e,f from b;</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>3、说明：跨数据库之间表的拷贝(具体数据使用绝对路径) (Access可用)<br></strong><span style="color: blue;">insert into b(a, b, c)
            select d,e,f from b in ‘具体数据库’ where&nbsp;条件<br></span>例子：..from b in
        '"&amp;Server.MapPath(".")&amp;"\data.mdb" &amp;"' where..</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>4、说明：子查询(表名1：a 表名2：b)<br></strong><span style="color: blue;">select a,b,c from a where a IN (select d
            from b )&nbsp;或者: select a,b,c from a where a IN (1,2,3)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>5、说明：显示文章、提交人和最后回复时间<br></strong><span style="color: blue;">select a.title,a.username,b.adddate from
            table a,(select max(adddate) adddate from table where table.title=a.title) b</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>6、说明：外连接查询(表名1：a 表名2：b)<br></strong><span style="color: blue;">select a.a, a.b, a.c, b.c, b.d, b.f from
            a LEFT OUT JOIN b ON a.a = b.c</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">7、说明：在线视图查询(表名1：a )<br></span></strong><span style="color: blue;">select *
            from (SELECT a,b,c FROM a) T where t.a &gt; 1;</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>8、说明：between的用法,between限制查询数据范围时包括了边界值,not between不包括<br></strong><span style="color: blue;">select *
            from table1 where time between time1 and time2<br>select a,b,c, from table1 where a not between&nbsp;数值1
            and&nbsp;数值2</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>9、说明：in 的使用方法<br></strong><span style="color: blue;">select * from table1 where a [not] in
            (‘值1’,’值2’,’值4’,’值6’)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>10、说明：两张关联表，删除主表中已经在副表中没有的信息&nbsp;<br></strong><span style="color: blue;">delete from table1 where not
            exists ( select * from table2 where table1.field1=table2.field1 )</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>11、说明：四表联查问题：<br></strong><span style="color: blue;">select * from a left inner join b on a.a=b.b right
            inner join c on a.a=c.c inner join d on a.a=d.d where&nbsp;</span><span style="color: green;">.....</span>
    </p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">12、说明：日程安排提前五分钟提醒&nbsp;<br></span></strong><span style="color: blue;">SQL:
            select * from&nbsp;日程安排&nbsp;where datediff('minute',f开始时间,getdate())&gt;5</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="font-size: 16px;color: green;">13</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: green;">、说明：一条</span></strong><strong><span
                style="font-size: 16px;color: green;">sql&nbsp;</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: green;">语句搞定数据库分页</span></strong><span
            style="font-size: 16px;color: blue;">select top 10 b.* from (select top 20&nbsp;</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">主键字段</span><span
            style="font-size: 16px;color: blue;">,</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">排序字段</span><span
            style="font-size: 16px;color: blue;">&nbsp;from&nbsp;</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">表名</span><span
            style="font-size: 16px;color: blue;">&nbsp;order by&nbsp;</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">排序字段</span><span
            style="font-size: 16px;color: blue;">&nbsp;desc) a,</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">表名</span><span
            style="font-size: 16px;color: blue;">&nbsp;b where b.</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">主键字段</span><span
            style="font-size: 16px;color: blue;">&nbsp;= a.</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">主键字段</span><span
            style="font-size: 16px;color: blue;">&nbsp;order by a.</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">排序字段</span><strong><span
                style="font-size: 16px;font-family: 宋体;">具体实现：</span></strong><span
            style="font-size: 16px;font-family: 宋体;color: blue;">关于数据库分页：</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <span style="font-size: 16px;font-family: 宋体;color: blue;">&nbsp;&nbsp;declare @start int,@end int</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <span style="font-size: 16px;font-family: 宋体;color: blue;">&nbsp;&nbsp;@sql&nbsp;&nbsp;nvarchar(600)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <span style="font-size: 16px;font-family: 宋体;color: blue;">&nbsp;&nbsp;set @sql=</span><span
            style="font-size: 16px;font-family: 宋体;color: red;">’select top’</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">+</span><span
            style="font-size: 16px;font-family: 宋体;color: red;">str</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">(@end-@start+1)+</span><span
            style="font-size: 16px;font-family: 宋体;color: red;">’+from T where rid not in(select top’</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">+</span><span
            style="font-size: 16px;font-family: 宋体;color: red;">str</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">(@str-1)+</span><span
            style="font-size: 16px;font-family: 宋体;color: red;">’Rid from T where Rid&gt;-1)’</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <span style="font-size: 16px;font-family: 宋体;color: blue;">&nbsp;&nbsp;exec sp_executesql @sql</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="font-size: 16px;font-family: 宋体;">注意：在</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: red;">top</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;">后不能直接跟一个变量，所以在实际应用中只有这样的进行特殊的处理。</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: red;">Rid</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;">为一个标识列，如果</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: red;">top</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;">后还有具体的字段，这样做是非常有好处的。因为这样可以避免</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: red;">&nbsp;top</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;">的字段如果是逻辑索引的，查询的结果后实际表中的不一致（</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: green;">逻辑索引中的数据有可能和数据表中的不一致，而查询时如果处在索引则首先查询索引</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;">）</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">14、说明：前10条记录<br></span></strong><span style="color: blue;">select top 10 *
            form table1 where&nbsp;范围</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span
                style="color: green;">15、说明：选择在每一组b值相同的数据中对应的a最大的记录的所有信息(类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等.)<br></span></strong><span
            style="color: blue;">select</span>&nbsp;a,b,c<span style="color: blue;">&nbsp;from&nbsp;</span>tablename
        ta<span style="color: blue;">&nbsp;where a=(select max(a) from tablename tb where tb.b=ta.b)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">16、说明：包括所有在&nbsp;</span>TableA<span
                style="color: green;">中但不在&nbsp;</span>TableB<span style="color: green;">和</span>TableC<span
                style="color: green;">中的行并消除所有重复行而派生出一个结果表<br></span></strong><span style="color: blue;">(select a from
            tableA ) except (select a from tableB) except (select a from tableC)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">17、说明：随机取出10条数据<br></span></strong><span style="color: blue;">select top 10
            * from&nbsp;</span>tablename<span style="color: blue;">&nbsp;order by&nbsp;<strong>newid()</strong></span>
    </p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">18、说明：随机选择记录<br></span></strong><span style="color: blue;">select
            newid()</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">19、说明：删除重复记录<br>1),</span></strong><span style="color: blue;">delete from
            tablename where id not in (select max(id) from tablename group by col1,col2,...)<br></span><strong><span
                style="color: red;">2)</span></strong><span style="color: blue;">,select distinct * into temp
            from&nbsp;</span><span style="color: red;">tablename</span><span style="color: blue;"><br>&nbsp;&nbsp;delete
            from&nbsp;</span><span style="color: red;">tablename</span><span style="color: blue;"><br>&nbsp;&nbsp;insert
            into&nbsp;</span><span style="color: red;">tablename</span><span style="color: blue;">&nbsp;select * from
            temp<br></span><strong><span
                style="color: green;">评价：这种操作牵连大量的数据的移动，这种做法不适合大容量但数据操作</span>3),例如：在一个外部表中导入数据，由于某些原因第一次只导入了一部分，但很难判断具体位置，这样只有在下一次全部导入，这样也就产生好多重复的字段，怎样删除重复字段</strong>
    </p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">alter table&nbsp;</span><span style="color: red;">tablename<br></span><span
            style="color: green;">--添加一个自增列<br></span><span style="color: blue;">add&nbsp;&nbsp;</span><span
            style="color: red;">column_b</span><span style="color: blue;">&nbsp;int identity(1,1)<br>&nbsp;delete
            from&nbsp;</span><span style="color: red;">tablename</span><span style="color: blue;">&nbsp;where column_b
            not in(<br>select&nbsp;</span><span style="color: red;">max(column_b</span><span
            style="color: blue;">)&nbsp;&nbsp;from&nbsp;</span><span style="color: red;">tablename</span><span
            style="color: blue;">&nbsp;group by</span><span style="color: red;">&nbsp;column1,column2,...</span><span
            style="color: blue;">)<br>alter table&nbsp;</span><span style="color: red;">tablename</span><span
            style="color: blue;">&nbsp;drop column&nbsp;</span><span style="color: red;">column_b</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">20、说明：列出数据库里所有的表名<br></span></strong><span style="color: blue;">select name
            from sysobjects where type='U' // U代表用户</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">21、说明：列出表里的所有的列名<br></span></strong><span style="color: blue;">select name
            from syscolumns where id=object_id('TableName')</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">22、说明：列示type、vender、pcs字段，以type字段排列，case可以方便地实现多重选择，类似select
                中的case。<br></span></strong><span style="color: blue;">select type,sum(case vender when 'A' then pcs else
            0 end),sum(case vender when 'C' then pcs else 0 end),sum(case vender when 'B' then pcs else 0 end) FROM
            tablename group by type<br></span><strong>显示结果：<br><span style="color: rgb(255, 102, 0);">type vender
                pcs<br></span></strong><span style="color: rgb(255, 102, 0);">电脑&nbsp;A 1<br>电脑&nbsp;A 1<br>光盘&nbsp;B
            2<br>光盘&nbsp;A 2<br>手机&nbsp;B 3<br>手机&nbsp;C 3</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">23、说明：初始化表table1</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">TRUNCATE TABLE table1</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">24、说明：选择从10到15的记录<br></span></strong><span style="color: blue;">select top 5
            * from (select top 15 * from table order by id asc) table_别名&nbsp;order by id desc</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: center;background: white;">
        <strong><span style="font-size: 24px;font-family: 华文隶书;color: red;">三、技巧</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">1、1=1，1=2的使用，在SQL语句组合时用的较多</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: blue;">“where 1=1”&nbsp;是表示选择全部&nbsp;&nbsp;&nbsp; “where
                1=2”全部不选，</span></strong><br>如：<br><span style="color: maroon;">if @strWhere !=''&nbsp;<br>begin<br>set
            @strSQL = 'select count(*) as Total from [' + @tblName + '] where ' +
            @strWhere&nbsp;<br>end<br>else&nbsp;<br>begin<br>set @strSQL = 'select count(*) as Total from [' + @tblName
            + ']'&nbsp;<br>end</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>我们可以直接写成</strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        错误！未找到目录项。<strong><span style="color: blue;"><br>set @strSQL = 'select count(*) as Total from [' + @tblName + ']
                where 1=1&nbsp;安定&nbsp;'+ @strWhere&nbsp;</span><span
                style="color: green;">2、收缩数据库<br></span></strong>--重建索引<br>DBCC REINDEX<br>DBCC
        INDEXDEFRAG<br>--收缩数据和日志<br>DBCC SHRINKDB<br>DBCC SHRINKFILE</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">3、压缩数据库<br></span></strong>dbcc shrinkdatabase(dbname)</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">4、转移数据库给新用户以已存在用户权限<br></span></strong>exec sp_change_users_login
        'update_one','newname','oldname'<br>go</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">5、检查备份集<br></span></strong>RESTORE VERIFYONLY from disk='E:\dvbbs.bak'</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">6、修复数据库<br></span></strong>ALTER DATABASE [dvbbs] SET
        SINGLE_USER<br>GO<br>DBCC CHECKDB('dvbbs',repair_allow_data_loss) WITH TABLOCK<br>GO<br>ALTER DATABASE [dvbbs]
        SET MULTI_USER<br>GO</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">7、日志清除<br></span></strong>SET NOCOUNT ON<br>DECLARE @LogicalFileName
        sysname,<br>&nbsp;@MaxMinutes INT,<br>&nbsp;@NewSize INT</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <br>USE tablename --&nbsp;要操作的数据库名<br>SELECT&nbsp;&nbsp;@LogicalFileName = 'tablename_log',
        --&nbsp;日志文件名<br>@MaxMinutes = 10, -- Limit on time allowed to wrap log.<br>&nbsp;@NewSize =
        1&nbsp;&nbsp;--&nbsp;你想设定的日志文件的大小(M)</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        Setup / initialize<br>DECLARE @OriginalSize int<br>SELECT @OriginalSize = size&nbsp;<br>&nbsp;FROM
        sysfiles<br>&nbsp;WHERE name = @LogicalFileName<br>SELECT 'Original Size of ' + db_name() + ' LOG is '
        +&nbsp;<br>&nbsp;CONVERT(VARCHAR(30),@OriginalSize) + ' 8K pages or '
        +&nbsp;<br>&nbsp;CONVERT(VARCHAR(30),(@OriginalSize*8/1024)) + 'MB'<br>&nbsp;FROM sysfiles<br>&nbsp;WHERE name =
        @LogicalFileName<br>CREATE TABLE DummyTrans<br>&nbsp;(DummyColumn char (8000) not null)</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <br>DECLARE @Counter&nbsp;&nbsp;&nbsp; INT,<br>&nbsp;@StartTime DATETIME,<br>&nbsp;@TruncLog&nbsp;&nbsp;
        VARCHAR(255)<br>SELECT @StartTime = GETDATE(),<br>&nbsp;@TruncLog = 'BACKUP LOG ' + db_name() + ' WITH
        TRUNCATE_ONLY'</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        DBCC SHRINKFILE (@LogicalFileName, @NewSize)<br>EXEC (@TruncLog)<br>-- Wrap the log if necessary.<br>WHILE
        @MaxMinutes &gt; DATEDIFF (mi, @StartTime, GETDATE()) -- time has not expired<br>&nbsp;AND @OriginalSize =
        (SELECT size FROM sysfiles WHERE name = @LogicalFileName)&nbsp;&nbsp;<br>&nbsp;AND (@OriginalSize * 8 /1024)
        &gt; @NewSize&nbsp;&nbsp;<br>&nbsp;BEGIN -- Outer loop.<br>SELECT @Counter = 0<br>&nbsp;WHILE&nbsp;&nbsp;
        ((@Counter &lt; @OriginalSize / 16) AND (@Counter &lt; 50000))<br>&nbsp;BEGIN -- update<br>&nbsp;INSERT
        DummyTrans VALUES ('Fill Log') DELETE DummyTrans<br>&nbsp;SELECT @Counter = @Counter +
        1<br>&nbsp;END<br>&nbsp;EXEC (@TruncLog)&nbsp;&nbsp;<br>&nbsp;END<br>SELECT 'Final Size of ' + db_name() + ' LOG
        is ' +<br>&nbsp;CONVERT(VARCHAR(30),size) + ' 8K pages or ' +&nbsp;<br>&nbsp;CONVERT(VARCHAR(30),(size*8/1024))
        + 'MB'<br>&nbsp;FROM sysfiles&nbsp;<br>&nbsp;WHERE name = @LogicalFileName<br>DROP TABLE DummyTrans<br>SET
        NOCOUNT OFF</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">8、说明：更改某个表<br></span></strong><span style="color: blue;">exec
            sp_changeobjectowner 'tablename','dbo'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">9、存储更改全部表</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        CREATE PROCEDURE dbo.User_ChangeObjectOwnerBatch<br>@OldOwner as NVARCHAR(128),<br>@NewOwner as
        NVARCHAR(128)<br>AS</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        DECLARE @Name&nbsp;&nbsp;&nbsp; as NVARCHAR(128)<br>DECLARE @Owner&nbsp;&nbsp; as NVARCHAR(128)<br>DECLARE
        @OwnerName&nbsp;&nbsp; as NVARCHAR(128)</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        DECLARE curObject CURSOR FOR&nbsp;<br>select 'Name'&nbsp;&nbsp;&nbsp; = name,<br>&nbsp;&nbsp;
        'Owner'&nbsp;&nbsp;&nbsp; = user_name(uid)<br>from sysobjects<br>where user_name(uid)=@OldOwner<br>order by name
    </p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        OPEN&nbsp;&nbsp; curObject<br>FETCH NEXT FROM curObject INTO @Name,
        @Owner<br>WHILE(@@FETCH_STATUS=0)<br>BEGIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>if
        @Owner=@OldOwner&nbsp;<br>begin<br>&nbsp;&nbsp; set @OwnerName = @OldOwner + '.' + rtrim(@Name)<br>&nbsp;&nbsp;
        exec sp_changeobjectowner @OwnerName, @NewOwner<br>end<br>-- select @name,@NewOwner,@OldOwner</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        FETCH NEXT FROM curObject INTO @Name, @Owner<br>END</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        close curObject<br>deallocate curObject<br><span style="font-size: 12px;">GO</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: green;">10、SQL SERVER中直接循环写入数据<br></span></strong><span
            style="font-size: 19px;color: blue;">declare @i int<br>set @i=1<br>while
            @i&lt;30<br>begin<br>&nbsp;&nbsp;&nbsp;&nbsp;insert into test (userid)
            values(@i)<br>&nbsp;&nbsp;&nbsp;&nbsp;set @i=@i+1<br>end<br></span><strong><span
                style="font-size: 16px;">案例</span></strong><strong><span
                style="font-size: 12px;">：<br></span></strong><strong>有如下表，要求就裱中所有沒有及格的成績，在每次增長0.1的基礎上，使他們剛好及格:</strong>
    </p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon;">Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">Zhangshan</span>&nbsp;&nbsp;&nbsp;<span
            style="color: teal;">80</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">Lishi&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
            style="color: teal;">59</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">Wangwu&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
            style="color: teal;">50</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">Songquan</span>&nbsp;&nbsp;&nbsp;&nbsp;<span
            style="color: teal;">69</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">while((select&nbsp;</span></strong><strong><span
                style="color: red;">min</span></strong><strong><span style="color: blue;">(score) from
                tb_table)&lt;</span></strong><strong>60</strong><strong><span style="color: blue;">)</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">begin</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">update tb_table set
                score&nbsp;</span></strong><strong>=</strong><strong><span
                style="color: blue;">score*</span></strong><strong>1.01</strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">where score</span></strong><strong>&lt;60</strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">if&nbsp;&nbsp;(select&nbsp;</span></strong><strong><span
                style="color: red;">min</span></strong><strong><span style="color: blue;">(score) from
                tb_table)</span></strong><strong>&gt;60</strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">&nbsp;&nbsp;break</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">&nbsp;else</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">&nbsp;&nbsp;&nbsp;&nbsp;continue</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">end</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        <br></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: center;background: white;">
        <strong><span style="font-size: 24px;font-family: 华文隶书;color: red;">数据开发-经典</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>1.按姓氏笔画排序:</strong><span style="color: blue;"><br>Select * From TableName Order By CustomerName Collate
            Chinese_PRC_Stroke_ci_as //从少到多</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>2.数据库加密:</strong><span style="color: blue;">select encrypt('原始密码')<br>select
            pwdencrypt('原始密码')<br>select pwdcompare('原始密码','加密后密码') = 1--相同；否则不相同 encrypt('原始密码')<br>select
            pwdencrypt('原始密码')<br>select pwdcompare('原始密码','加密后密码') = 1--相同；否则不相同</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>3.取回表中字段:<br></strong><span style="color: blue;">declare @list varchar(1000),<br>@sql
            nvarchar(1000)&nbsp;<br>select @list=@list+</span><span style="color: red;">','</span><span
            style="color: blue;">+b.name from sysobjects a,syscolumns b where a.id=b.id and a.name=</span><span
            style="color: red;">'表A'<br></span><span style="color: blue;">set @sql=</span><span
            style="color: red;">'select '</span><span style="color: blue;">+right(@list,len(@list)-1)+</span><span
            style="color: red;">' from&nbsp;表A</span><span style="color: blue;">'&nbsp;<br>exec (@sql)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>4.查看硬盘分区:<br><span style="color: blue;">EXEC master..xp_fixeddrives</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>5.比较A,B表是否相等:<br></strong><span style="color: blue;">if (select checksum_agg(binary_checksum(*)) from
            A)<br>&nbsp;&nbsp;&nbsp;&nbsp; =<br>&nbsp;&nbsp;&nbsp; (select checksum_agg(binary_checksum(*)) from
            B)<br>print '相等'<br>else<br>print '不相等'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>6.杀掉所有的事件探察器进程:<br></strong><span style="color: blue;">DECLARE hcforeach CURSOR GLOBAL FOR SELECT 'kill
            '+RTRIM(spid) FROM master.dbo.sysprocesses<br>WHERE program_name IN('SQL
            profiler',N'SQL&nbsp;事件探查器')<br>EXEC sp_msforeach_worker '?</span><span
            style="font-size: 12px;color: blue;">'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="font-size: 16px;">7.</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;">记录搜索</span></strong><strong><span
                style="font-size: 16px;">:<br></span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: blue;">开头到</span></strong><strong><span
                style="font-size: 16px;color: blue;">N</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: blue;">条记录</span></strong><span
            style="font-size: 16px;color: blue;">Select Top N * From&nbsp;</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">表</span><span
            style="font-size: 12px;color: blue;">-------------------------------<br></span><strong><span
                style="font-size: 16px;color: blue;">N</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: blue;">到</span></strong><strong><span
                style="font-size: 16px;color: blue;">M</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: blue;">条记录</span></strong><strong><span
                style="font-size: 16px;color: blue;">(</span></strong><strong><span
                style="font-size: 16px;font-family: 宋体;color: blue;">要有主索引</span></strong><strong><span
                style="font-size: 16px;color: blue;">ID)<br></span></strong><span
            style="font-size: 16px;color: blue;">Select Top M-N * From&nbsp;</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">表</span><span
            style="font-size: 16px;color: blue;">&nbsp;Where ID in (Select Top M ID From&nbsp;</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">表</span><span style="font-size: 16px;color: blue;">)
            Order by ID&nbsp;&nbsp; Desc<br>----------------------------------<br><strong>N</strong></span><strong><span
                style="font-size: 16px;font-family: 宋体;color: blue;">到结尾记录</span></strong><span
            style="font-size: 16px;color: blue;">Select Top N * From&nbsp;</span><span
            style="font-size: 16px;font-family: 宋体;color: blue;">表</span><span
            style="font-size: 16px;color: blue;">&nbsp;Order by ID Desc<br></span><strong><span
                style="font-size: 16px;font-family: 宋体;color: green;">案例</span></strong><strong><span
                style="font-family: 宋体;">例如1：一张表有一万多条记录，表的第一个字段 RecID 是自增长字段， 写一个SQL语句，
                找出表的第</span></strong><strong><span style="font-family: 宋体;color: red;">31</span></strong><strong><span
                style="font-family: 宋体;">到第</span></strong><strong><span
                style="font-family: 宋体;color: red;">40</span></strong><strong><span
                style="font-family: 宋体;">个记录。</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <span style="font-family: 宋体;color: blue;">&nbsp;select top 10 recid from A where recid not&nbsp;&nbsp;in(select
            top 30 recid from A)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <span style="font-family: 宋体;color: blue;">分析：如果这样写会产生某些问题，如果recid在表中存在逻辑索引。</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <span style="font-family: 宋体;color: blue;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family: 宋体;">select
            top 10 recid from A where……是从索引中查找，而后面的</span><span style="font-family: 宋体;color: blue;">select top 30 recid
            from A</span><span style="font-family: 宋体;">则在数据表中查找，这样由于索引中的顺序有可能和数据表中的不一致，这样就导致查询到的不是本来的欲得到的数据。</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="font-family: 宋体;">解决方案</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="font-family: 宋体;">1，</span></strong><strong><span style="font-family: 宋体;">用order
                by&nbsp;</span></strong><span style="font-family: 宋体;color: blue;">select top 30 recid from A order by
            ricid&nbsp;</span><strong><span style="font-family: 宋体;">如果该字段不是自增长，就会出现问题</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: green;">2，</span></strong><strong><span
                style="font-family: 宋体;">在那个子查询中也加条件：</span></strong>select top 30 recid from A where recid&gt;-1</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="font-family: 宋体;">例</span>2</strong><strong><span
                style="font-family: 宋体;">：查询表中的最后以条记录，并不知道这个表共有多少数据</span>,</strong><strong><span
                style="font-family: 宋体;">以及表结构。</span><br><span style="color: blue;">set&nbsp;</span>@s<span
                style="color: blue;">&nbsp;=&nbsp;</span><span style="color: red;">'select top 1 * from
                T&nbsp;&nbsp;&nbsp;where pid not in (select top '</span><span style="color: blue;">&nbsp;+</span><span
                style="color: fuchsia;">&nbsp;str</span><span style="color: blue;">(</span>@count-1<span
                style="color: blue;">) +&nbsp;</span><span style="color: red;">'
                pid&nbsp;&nbsp;from&nbsp;&nbsp;T)'</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;font-size: 13px;line-height: 19.5px;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;text-align: left;background-color: rgb(255, 255, 255);">
        <strong><span style="color: blue;">print&nbsp;</span>@s<span
                style="color: blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;&nbsp;</span><span
                style="color: fuchsia;">sp_executesql</span><span style="color: blue;">&nbsp;&nbsp;</span>@s</strong>
    </p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>9：获取当前数据库中的所有用户表</strong><br><span style="color: blue;">select Name from sysobjects where xtype='u' and
            status&gt;=0</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>10：获取某一个表的所有字段<br></strong><span style="color: blue;">select name from&nbsp;</span><span
            style="color: green;">syscolumns</span><span style="color: blue;">&nbsp;where id=</span><span
            style="color: red;">object_id</span><span style="color: blue;">('表名')</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select name from&nbsp;</span><span style="color: green;">syscolumns</span><span
            style="color: blue;">&nbsp;where id in (select id from&nbsp;</span><span
            style="color: green;">sysobjects</span><span style="color: blue;">&nbsp;where type = 'u' and name =
            '表名')</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: green;">两种方式的效果相同</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>11：查看与某一个表相关的视图、存储过程、函数</strong><span style="color: blue;">select a.* from&nbsp;</span><span
            style="color: green;">sysobjects</span><span style="color: blue;">&nbsp;a,&nbsp;</span><span
            style="color: green;">syscomments</span><span style="color: blue;">&nbsp;b where a.id = b.id and b.text like
            '%表名%'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>12：查看当前数据库中所有存储过程<br></strong><span style="color: blue;">select name
            as&nbsp;存储过程名称&nbsp;from&nbsp;</span><span style="color: green;">sysobjects</span><span
            style="color: blue;">&nbsp;where xtype='P'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>13：查询用户创建的所有数据库</strong><span style="color: blue;">select * from master..</span><span
            style="color: green;">sysdatabases</span><span style="color: blue;">&nbsp;D where sid not in(select sid from
            master..</span><span style="color: green;">syslogins</span><span style="color: blue;">&nbsp;where
            name='sa')<br>或者<br>select dbid, name AS DB_NAME from master..s</span><span
            style="color: green;">ysdatabases</span><span style="color: blue;">&nbsp;where sid &lt;&gt; 0x01</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>14：查询某一个表的字段和数据类型<br></strong><span style="color: blue;">select column_name,data_type from
            information_schema.columns<br>where table_name = '表名'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>15</strong><strong>：不同服务器数据库之间的数据操作</strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">--</span></strong><strong><span
                style="color: green;">创建链接服务器</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">exec sp_addlinkedserver&nbsp;&nbsp;&nbsp;'ITSV ', ' ', 'SQLOLEDB ',
            '远程服务器名或ip地址&nbsp;'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">exec sp_addlinkedsrvlogin&nbsp;&nbsp;'ITSV ', 'false ',null, '用户名&nbsp;',
            '密码&nbsp;'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--查询示例</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select * from ITSV.数据库名.dbo.表名</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--导入示例</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select * into&nbsp;表&nbsp;from ITSV.数据库名.dbo.表名</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">--</span></strong><strong><span
                style="color: green;">以后不再使用时删除链接服务器</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">exec sp_dropserver&nbsp;&nbsp;'ITSV ', 'droplogins '</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">&nbsp;</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="color: green;">--</span></strong><strong><span
                style="color: green;">连接远程/局域网数据</span></strong><span
            style="color: blue;">(openrowset/openquery/opendatasource)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">--1、openrowset</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--查询示例</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select * from openrowset( 'SQLOLEDB ', 'sql服务器名&nbsp;'; '用户名&nbsp;';
            '密码&nbsp;',数据库名.dbo.表名)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--生成本地表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select * into&nbsp;表&nbsp;from openrowset( 'SQLOLEDB ', 'sql服务器名&nbsp;'; '用户名&nbsp;';
            '密码&nbsp;',数据库名.dbo.表名)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">&nbsp;</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--把本地表导入远程表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">insert openrowset( 'SQLOLEDB ', 'sql服务器名&nbsp;'; '用户名&nbsp;';
            '密码&nbsp;',数据库名.dbo.表名)</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select *from&nbsp;本地表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--更新本地表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">update b</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">set b.列A=a.列A</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">&nbsp;from openrowset( 'SQLOLEDB ', 'sql服务器名&nbsp;'; '用户名&nbsp;';
            '密码&nbsp;',数据库名.dbo.表名)as a inner join&nbsp;本地表&nbsp;b</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">on a.column1=b.column1</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">--openquery用法需要创建一个连接</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">-</span><span style="color: red;">-首先创建一个连接创建链接服务器</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">exec sp_addlinkedserver&nbsp;&nbsp;&nbsp;'ITSV ', ' ', 'SQLOLEDB ',
            '远程服务器名或ip地址&nbsp;'</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">--查询</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select *</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">FROM openquery(ITSV,&nbsp;&nbsp;'SELECT
            *&nbsp;&nbsp;FROM&nbsp;数据库.dbo.表名&nbsp;')</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--把本地表导入远程表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">insert openquery(ITSV,&nbsp;&nbsp;'SELECT
            *&nbsp;&nbsp;FROM&nbsp;数据库.dbo.表名&nbsp;')</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select * from&nbsp;本地表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: red;">--更新本地表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">update b</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">set b.列B=a.列B</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">FROM openquery(ITSV,&nbsp;&nbsp;'SELECT * FROM&nbsp;数据库.dbo.表名&nbsp;') as
            a&nbsp;</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">inner join&nbsp;本地表&nbsp;b on a.列A=b.列A</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">&nbsp;</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: green;">--3、opendatasource/openrowset</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">SELECT&nbsp;&nbsp;&nbsp;*</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">FROM&nbsp;&nbsp;&nbsp;opendatasource( 'SQLOLEDB ',&nbsp;&nbsp;'Data
            Source=ip/ServerName;User ID=登陆名;Password=密码&nbsp;' ).test.dbo.roy_ta</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: green;">--把本地表导入远程表</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">insert opendatasource( 'SQLOLEDB ',&nbsp;&nbsp;'Data Source=ip/ServerName;User
            ID=登陆名;Password=密码&nbsp;').数据库.dbo.表名</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="color: blue;">select * from&nbsp;本地表&nbsp;</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: center;background: white;">
        <strong><span style="font-size: 24px;font-family: 宋体;color: red;font-weight: normal;">SQL
                Server</span></strong><strong><span
                style="font-size: 24px;font-family: 宋体;color: red;font-weight: normal;">基本函数</span></strong></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <span style="font-size: 12px;">SQL Server基本函数</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>1.字符串函数&nbsp;</strong><span style="font-size: 12px;">长度与分析用</span></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong><span style="font-size: 19px;color: fuchsia;">1,datalength</span></strong><span
            style="color: fuchsia;">(</span>Char_expr)&nbsp;返回字符串包含字符数,但不包含后面的空格<strong><span
                style="font-size: 19px;color: fuchsia;">2,substring</span></strong>(expression,start,length)&nbsp;取子串，字符串的下标是从“<span
            style="color: red;">1</span>”，start为起始位置，length为字符串长度，实际应用中以<span
            style="color: red;">len(expression)</span>取得其长度<strong><span
                style="font-size: 19px;color: fuchsia;">3,right</span></strong>(char_expr,int_expr)&nbsp;返回字符串右边第int_expr个字符，还用<strong><span
                style="color: fuchsia;">left</span></strong>于之相反<br><strong><span
                style="font-size: 19px;color: fuchsia;">4,isnull</span>(&nbsp;</strong><em>check</em><strong>_</strong><em>expression&nbsp;</em><strong>,</strong>&nbsp;<em>replacement_value&nbsp;</em><strong>)</strong>如果check_expression為空，則返回replacement_value的值，不為空，就返回check_expression字符操作类
    </p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background: white;">
        <strong>5,Sp_addtype</strong><span style="color: navy;">自定義數據類型<br></span><span
            style="font-size: 12px;color: navy;">例如：</span><code>EXEC sp_addtype birthday, datetime, 'NULL'</code></p>
    <p
        style="letter-spacing: 0.544px;white-space: normal;color: rgb(0, 0, 0);font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">
        &nbsp;</p>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong><span style="color: red;">6,set nocount {on|off}</span></strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">使返回的结果中不包含有关受 Transact-SQL 语句影响的行数的信息。如果存储过程中包含的一些语句并不返回许多实际的数据，则该设置由于大量减少了网络流量，因此可显著提高性能。SET NOCOUNT 设置是在执行或运行时设置，而不是在分析时设置。</pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">SET NOCOUNT 为 ON 时，不返回计数（表示受 Transact-SQL 语句影响的行数）。<br><br>SET NOCOUNT 为 OFF 时，返回计数</pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong><span style="font-size: 24px;color: red;">常识</span></strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong><span style="font-size: 24px;color: red;">&nbsp;</span></strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong><span style="color: red;">在SQL查询中：</span></strong></code><code><strong><span style="color: blue;">from</span></strong></code><code>后最多可以跟多少张表或视图：</code><code><strong><span style="color: blue;">256</span></strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong>在</strong></code><code><strong><span style="color: blue;">SQL</span></strong></code><code><strong>语句中出现 </strong></code><code><strong><span style="color: blue;">Order by</span></strong></code><code><strong>,</strong></code><code><strong>查询时，</strong></code><code><strong><span style="color: red;">先排序，后取</span></strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong>在</strong></code><code><strong><span style="color: blue;">SQL</span></strong></code><code><strong>中，一个字段的最大容量是</strong></code><code><strong><span style="color: red;">8000</span></strong></code><code><strong>，而对于</strong></code><code><strong><span style="color: red;">nvarchar(4000)</span></strong></code><code><strong>,</strong></code><code><strong>由于</strong></code><code><strong><span style="color: red;">nvarchar</span></strong></code><code><strong>是Unicode码。&nbsp;</strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code><strong><span style="font-size: 19px;">SQLServer2000</span></strong></code><code><strong><span style="font-size: 19px;">同步复制技术实现步骤</span></strong></code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>一、 预备工作</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>1.</code><code>发布服务器,订阅服务器都创建一个同名的windows用户,并设置相同的密码,做为发布快照文件夹的有效访问用户</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>管理工具</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>计算机管理</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>用户和组</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>右键用户</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>新建用户</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>建立一个隶属于administrator组的登陆windows的用户（SynUser）</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>2.</code><code>在发布服务器上,新建一个共享目录,做为发布的快照文件的存放目录,操作:</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>我的电脑--D:\ 新建一个目录,名为: PUB</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>右键这个新建的目录</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>属性--共享</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>选择"共享该文件夹"</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>通过"权限"按纽来设置具体的用户权限,保证第一步中创建的用户(SynUser) 具有对该文件夹的所有权限</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>确定</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>3.</code><code>设置SQL代理(SQLSERVERAGENT)服务的启动用户(发布/订阅服务器均做此设置)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>开始--程序--管理工具--服务</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>右键SQLSERVERAGENT</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>属性--登陆--选择"此账户"</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>输入或者选择第一步中创建的windows登录用户名（SynUser）</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>密码"中输入该用户的密码</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>4.</code><code>设置SQL Server身份验证模式,解决连接时的权限问题(发布/订阅服务器均做此设置)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>企业管理器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>右键SQL实例--属性</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>安全性--身份验证</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>选择"SQL Server 和 Windows"</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>确定</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>5.</code><code>在发布服务器和订阅服务器上互相注册</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>企业管理器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>右键SQL Server组</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>新建SQL Server注册...</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>下一步--可用的服务器中,输入你要注册的远程服务器名 --添加</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>下一步--连接使用,选择第二个"SQL Server身份验证"</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>下一步--输入用户名和密码（SynUser）</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>下一步--选择SQL Server组,也可以创建一个新组</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>下一步--完成</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>6.</code><code>对于只能用IP,不能用计算机名的,为其注册服务器别名（此步在实施中没用到）</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code> (</code><code>在连接端配置,比如,在订阅服务器上配置的话,服务器名称中输入的是发布服务器的IP)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>开始--程序--Microsoft SQL Server--客户端网络实用工具</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>别名--添加</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>网络库选择"tcp/ip"--服务器别名输入SQL服务器名</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>连接参数--服务器名称中输入SQL服务器ip地址</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>如果你修改了SQL的端口,取消选择"动态决定端口",并输入对应的端口号</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>二、 正式配置</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>1</code><code>、配置发布服务器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>打开企业管理器，在发布服务器（B、C、D）上执行以下步骤:</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(1) </code><code>从[工具]下拉菜单的[复制]子菜单中选择[配置发布、订阅服务器和分发]出现配置发布和分发向导</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(2) [</code><code>下一步] 选择分发服务器 可以选择把发布服务器自己作为分发服务器或者其他sql的服务器（选择自己）</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(3) [</code><code>下一步] 设置快照文件夹</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>采用默认\\servername\Pub</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(4) [</code><code>下一步] 自定义配置</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>可以选择:是,让我设置分发数据库属性启用发布服务器或设置发布设置</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>否,使用下列默认设置（推荐）</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(5) [</code><code>下一步] 设置分发数据库名称和位置 采用默认值</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(6) [</code><code>下一步] 启用发布服务器 选择作为发布的服务器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);">(7) [下一步] 选择需要发布的数据库和发布类型</pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(8) [</code><code>下一步] 选择注册订阅服务器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(9) [</code><code>下一步] 完成配置</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>2</code><code>、创建出版物</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>发布服务器B、C、D上</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(1)</code><code>从[工具]菜单的[复制]子菜单中选择[创建和管理发布]命令</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(2)</code><code>选择要创建出版物的数据库，然后单击[创建发布]</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(3)</code><code>在[创建发布向导]的提示对话框中单击[下一步]系统就会弹出一个对话框。对话框上的内容是复制的三个类型。我们现在选第一个也就是默认的快照发布(其他两个大家可以去看看帮助)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(4)</code><code>单击[下一步]系统要求指定可以订阅该发布的数据库服务器类型,</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>SQLSERVER</code><code>允许在不同的数据库如 orACLE或ACCESS之间进行数据复制。</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>但是在这里我们选择运行"SQL SERVER 2000"的数据库服务器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(5)</code><code>单击[下一步]系统就弹出一个定义文章的对话框也就是选择要出版的表</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>注意: 如果前面选择了事务发布 则再这一步中只能选择带有主键的表</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(6)</code><code>选择发布名称和描述</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(7)</code><code>自定义发布属性 向导提供的选择:</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>是 我将自定义数据筛选,启用匿名订阅和或其他自定义属性</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>否 根据指定方式创建发布 （建议采用自定义的方式）</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(8)[</code><code>下一步] 选择筛选发布的方式</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(9)[</code><code>下一步] 可以选择是否允许匿名订阅</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>1)</code><code>如果选择署名订阅,则需要在发布服务器上添加订阅服务器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>方法: [工具]-&gt;[复制]-&gt;[配置发布、订阅服务器和分发的属性]-&gt;[订阅服务器] 中添加</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>否则在订阅服务器上请求订阅时会出现的提示:改发布不允许匿名订阅</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>如果仍然需要匿名订阅则用以下解决办法</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>[</code><code>企业管理器]-&gt;[复制]-&gt;[发布内容]-&gt;[属性]-&gt;[订阅选项] 选择允许匿名请求订阅</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>2)</code><code>如果选择匿名订阅,则配置订阅服务器时不会出现以上提示</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(10)[</code><code>下一步] 设置快照 代理程序调度</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(11)[</code><code>下一步] 完成配置</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>当完成出版物的创建后创建出版物的数据库也就变成了一个共享数据库</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>有数据</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>srv1.</code><code>库名..author有字段:id,name,phone,</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>srv2.</code><code>库名..author有字段:id,name,telphone,adress</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>要求：</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>srv1.</code><code>库名..author增加记录则srv1.库名..author记录增加</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>srv1.</code><code>库名..author的phone字段更新，则srv1.库名..author对应字段telphone更新</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--*/</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>大致的处理步骤</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--1.</code><code>在 srv1 上创建连接服务器,以便在 srv1 中操作 srv2,实现同步</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>exec sp_addlinkedserver 'srv2','','SQLOLEDB','srv2</code><code>的sql实例名或ip'</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>exec sp_addlinkedsrvlogin 'srv2','false',null,'</code><code>用户名','密码'</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>go</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--2.</code><code>在 srv1 和 srv2 这两台电脑中,启动 msdtc(分布式事务处理服务),并且设置为自动启动</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>。我的电脑--控制面板--管理工具--服务--右键 Distributed Transaction Coordinator--属性--启动--并将启动类型设置为自动启动</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>go</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>然后创建一个作业定时调用上面的同步处理存储过程就行了</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>企业管理器</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>管理</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--SQL Server</code><code>代理</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>右键作业</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>新建作业</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>常规"项中输入作业名称</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>步骤"项</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>新建</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>步骤名"中输入步骤名</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>类型"中选择"Transact-SQL 脚本(TSQL)"</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>数据库"选择执行命令的数据库</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>命令"中输入要执行的语句: exec p_process</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>确定</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>调度"项</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>新建调度</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>名称"中输入调度名称</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--"</code><code>调度类型"中选择你的作业执行安排</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>如果选择"反复出现"</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>点"更改"来设置你的时间安排</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>然后将SQL Agent服务启动,并设置为自动启动,否则你的作业不会被执行</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>设置方法:</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>我的电脑--控制面板--管理工具--服务--右键 SQLSERVERAGENT--属性--启动类型--选择"自动启动"--确定.</code></pre>
    
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--3.</code><code>实现同步处理的方法2,定时同步</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>在srv1中创建如下的同步处理存储过程</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>create proc p_process</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>as</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>更新修改过的数据</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>update b set name=i.name,telphone=i.telphone</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>from srv2.</code><code>库名.dbo.author b,author i</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>where b.id=i.id and</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>(b.name &lt;&gt; i.name or b.telphone &lt;&gt; i.telphone)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>插入新增的数据</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>insert srv2.</code><code>库名.dbo.author(id,name,telphone)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>select id,name,telphone from author i</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>where not exists(</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>select * from srv2.</code><code>库名.dbo.author where id=i.id)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>&nbsp;</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>--</code><code>删除已经删除的数据(如果需要的话)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>delete b</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>from srv2.</code><code>库名.dbo.author b</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>where not exists(</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><code>select * from author where id=b.id)</code></pre>
    <pre
        style="letter-spacing: 0.544px;white-space: pre-wrap;color: rgb(0, 0, 0);font-size: 14px;text-align: left;background-color: rgb(255, 255, 255);"><p style="margin-bottom: 10px;"><span style="color: blue;">go</span></p></pre>
    
</div>